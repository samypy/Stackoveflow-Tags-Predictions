Sub CreateNewFileWithSheets()
    Dim wbSource As Workbook, wbNew As Workbook
    Dim wsData As Worksheet, wsChart As Worksheet, wsTemp As Worksheet
    Dim pt As PivotTable, sl As Slicer
    Dim newFileName As String
    
    ' Set the source workbook and sheets
    Set wbSource = ThisWorkbook
    Set wsData = wbSource.Sheets("over_All_data")
    Set wsChart = wbSource.Sheets("Over_All_Chart")
    
    ' Create a new workbook
    Set wbNew = Workbooks.Add
    
    ' Copy the data sheet
    wsData.Copy Before:=wbNew.Sheets(1)
    Set wsData = wbNew.Sheets(1)
    wsData.Name = "over_All_data"
    
    ' Convert the chart sheet to a regular worksheet
    wsChart.Copy After:=wbNew.Sheets(wbNew.Sheets.Count)
    Set wsTemp = wbNew.Sheets(wbNew.Sheets.Count)
    wsTemp.Name = "Over_All_Chart"
    wsTemp.Move After:=wsData
    
    ' Copy the pivot table
    Set pt = wsData.PivotTables("PivotTable10")
    pt.TableRange2.Copy Destination:=wsData.Range("A204")
    
    ' Update pivot table data source
    pt.ChangePivotCache wbNew.PivotCaches.Create(SourceType:=xlDatabase, SourceData:=wsData.Range("A1:G199"))
    
    ' Copy slicers
    For Each sl In wsTemp.Slicers
        sl.Copy
        wsData.Activate
        wsData.Shapes.Paste
        Application.CutCopyMode = False
    Next sl
    
    ' Delete the temporary chart sheet
    Application.DisplayAlerts = False
    wsTemp.Delete
    Application.DisplayAlerts = True
    
    ' Save the new workbook
    newFileName = "NewWorkbook.xlsx" ' Modify the filename as needed
    wbNew.SaveAs newFileName
    
    ' Close the new workbook
    wbNew.Close SaveChanges:=False
    
    ' Clean up objects
    Set wbSource = Nothing
    Set wbNew = Nothing
    Set wsData = Nothing
    Set wsChart = Nothing
    Set wsTemp = Nothing
    Set pt = Nothing
    Set sl = Nothing
    
    MsgBox "New Excel file created successfully!"
End Sub
