Sub GetLastRowOfFilteredTable()
    Dim ws As Worksheet
    Dim tbl As ListObject
    Dim lastRow As Long

    ' Set the worksheet containing your table
    Set ws = ThisWorkbook.Worksheets("Sheet1") ' Replace "Sheet1" with your sheet name

    ' Set the table
    Set tbl = ws.ListObjects("Table1") ' Replace "Table1" with your table name

    ' Check if a filter is applied
    If tbl.AutoFilter.FilterMode Then
        ' Find the last visible row in the filtered table
        On Error Resume Next
        lastRow = tbl.ListRows(tbl.ListRows.Count).Range.Row
lastRow = tbl.ListRows(tbl.ListRows.Count).Range.SpecialCells(xlCellTypeVisible).Row
        On Error GoTo 0
    Else
        ' If no filter is applied, get the last row in the table
        lastRow = tbl.ListRows.Count
    End If

    ' Display the last row number
    MsgBox "Last Row Number: " & lastRow
End Sub
lastRow = ws.Cells(ws.Rows.Count, "A").End(xlUp).Row
 ' Set the range to the desired column (e.g., column "A")
    Set rng = ws.Range("A:A")
    
    ' Find the last visible row with data starting from the bottom
    On Error Resume Next
    lastRow = rng.SpecialCells(xlCellTypeVisible).Row
 ' Initialize lastRow to 0
    lastRow = 0
    
    ' Loop through the table's rows to find the last visible row
    For Each row In tbl.ListRows
        If Not row.Range.EntireRow.Hidden Then
            ' If the row is not hidden, update lastRow
            lastRow = row.Index
        End If
    Next row
