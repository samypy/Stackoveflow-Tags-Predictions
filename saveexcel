Sub CopyWorkbookWithObjects()
    Dim oldWorkbook As Workbook
    Dim newWorkbook As Workbook
    Dim oldSheet As Worksheet
    Dim newSheet As Worksheet
    Dim pt As PivotTable
    Dim ch As ChartObject
    Dim sl As SlicerCache
    Dim wsName As String
    Dim ptName As String
    Dim chName As String
    Dim slName As String
    Dim chSeries As Series

    ' Set the source workbook (workbook to copy from)
    Set oldWorkbook = ThisWorkbook ' Change this to the workbook you want to copy from

    ' Create a new workbook
    Set newWorkbook = Workbooks.Add

    ' Loop through all sheets in the old workbook
    For Each oldSheet In oldWorkbook.Sheets
        wsName = oldSheet.Name
        oldSheet.Copy After:=newWorkbook.Sheets(newWorkbook.Sheets.Count)
        Set newSheet = newWorkbook.Sheets(newWorkbook.Sheets.Count)
        newSheet.Name = wsName
    Next oldSheet

    ' Loop through all pivot tables in the old workbook
    For Each pt In oldWorkbook.Sheets(1).PivotTables
        ptName = pt.Name
        pt.TableRange2.Copy
        newWorkbook.Sheets(1).Range("A1").PasteSpecial xlPasteValues
        Set pt = newWorkbook.Sheets(1).PivotTables.Add(PivotCache:=pt.PivotCache, TableDestination:=newWorkbook.Sheets(1).Range("A1"), TableName:=ptName)
    Next pt

    ' Loop through all charts in the old workbook
    For Each ch In oldWorkbook.Sheets(1).ChartObjects
        chName = ch.Name
        ch.Copy
        newWorkbook.Sheets(1).Paste
        Set ch = newWorkbook.Sheets(1).ChartObjects(newWorkbook.Sheets(1).ChartObjects.Count)
        ch.Name = chName
        
        ' Update the chart series data ranges
        For Each chSeries In ch.Chart.SeriesCollection
            chSeries.Formula = Replace(chSeries.Formula, oldWorkbook.Sheets(1).Name, newWorkbook.Sheets(1).Name)
        Next chSeries
    Next ch

    ' Loop through all slicers in the old workbook
    For Each sl In oldWorkbook.SlicerCaches
        slName = sl.Name
        sl.Copy
        Set sl = newWorkbook.SlicerCaches(newWorkbook.SlicerCaches.Count)
        sl.Name = slName
    Next sl

    Application.CutCopyMode = False
End Sub

Sub UpdateChartSeriesData()
    Dim ws As Worksheet
    Dim co As ChartObject
    Dim ch As Chart
    Dim series As Series

    ' Loop through all worksheets in the current workbook
    For Each ws In ThisWorkbook.Worksheets
        ' Loop through all chart objects in the worksheet
        For Each co In ws.ChartObjects
            Set ch = co.Chart
            ' Loop through all series in the chart
            For Each series In ch.SeriesCollection
                ' Update the series formula to refer to the current workbook
                series.Formula = Replace(series.Formula, ws.Parent.Name, ThisWorkbook.Name)
            Next series
        Next co
    Next ws
End Sub

Sub AddSlicerCachesToAllSheets()
    Dim wb As Workbook
    Dim wsSource As Worksheet
    Dim wsTarget As Worksheet
    Dim pt As PivotTable
    Dim sc As SlicerCache
    Dim slicerSheetName As String
    Dim newSlicerCache As SlicerCache

    ' Set the workbook object
    Set wb = ThisWorkbook ' Change this to the workbook containing the pivot tables

    ' Set the source worksheet where slicers are present
    Set wsSource = wb.Worksheets("SlicerSheetName") ' Replace "SlicerSheetName" with the actual name of the sheet where slicers are present

    ' Loop through all pivot tables in the source worksheet
    For Each pt In wsSource.PivotTables
        Set sc = pt.Slicers.Add(SlicerDestination:=wsSource, _
                                SourceType:=xlDatabase, _
                                SourceData:=pt.TableRange1, _
                                Name:=pt.Name & " Slicer")

        ' Loop through all available sheets in the workbook
        For Each wsTarget In wb.Sheets
            If wsTarget.Name <> wsSource.Name Then
                ' Copy the slicer cache to the target sheet
                Set newSlicerCache = sc.Parent.SlicerCaches.Add(sc.SourceType, sc.SourceData, sc.Name & " Copy")
                newSlicerCache.Copy
                wsTarget.Activate
                wb.SlicerCaches(wb.SlicerCaches.Count).Delete
            End If
        Next wsTarget
    Next pt
End Sub
