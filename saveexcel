Sub GetLastRowOfFilteredTable()
    Dim ws As Worksheet
    Dim tbl As ListObject
    Dim lastRow As Long

    ' Set the worksheet containing your table
    Set ws = ThisWorkbook.Worksheets("Sheet1") ' Replace "Sheet1" with your sheet name

    ' Set the table
    Set tbl = ws.ListObjects("Table1") ' Replace "Table1" with your table name

    ' Check if a filter is applied
    If tbl.AutoFilter.FilterMode Then
        ' Find the last visible row in the filtered table
        On Error Resume Next
        lastRow = tbl.ListRows(tbl.ListRows.Count).Range.Row
        On Error GoTo 0
    Else
        ' If no filter is applied, get the last row in the table
        lastRow = tbl.ListRows.Count
    End If

    ' Display the last row number
    MsgBox "Last Row Number: " & lastRow
End Sub
lastRow = ws.Cells(ws.Rows.Count, "A").End(xlUp).Row
