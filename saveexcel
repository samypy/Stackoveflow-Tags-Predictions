import pandas as pd

# Read the Excel file
df = pd.read_excel('your_file.xlsx', sheet_name='Sheet1')  # Replace 'your_file.xlsx' with your actual file name

# Define custom order for months
month_order = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec']

# Convert 'Month' column to Categorical data type with custom order
df['Month'] = pd.Categorical(df['Month'], categories=month_order, ordered=True)

# Aggregate duplicate rows
df_agg = df.groupby(['Account ID', 'Year', 'Month']).sum().reset_index()

# Pivot the aggregated data
pivot_df = df_agg.pivot(index='Account ID', columns=['Year', 'Month'], values='Duration').reset_index()

# Rename the column headers to have year_month format
pivot_df.columns = [f'{col[0]}_{col[1]}' if isinstance(col, tuple) else col for col in pivot_df.columns]

# Save the pivoted data to a new Excel file
pivot_df.to_excel('pivot_data.xlsx', index=False)
