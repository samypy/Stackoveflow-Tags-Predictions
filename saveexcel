import spacy
from spacy.training.example import Example

# Load a blank English model
nlp = spacy.blank("en")

# Add a new entity label for custom person names
nlp.add_pipe("ner", config={"labels": ["CUSTOM_PERSON"]})

# Define your training data
# Example data format: (text, {"entities": [(start, end, "CUSTOM_PERSON")]})
training_data = [
    ("Jan did a great job but Sam needs improvement.", {"entities": [(0, 3, "CUSTOM_PERSON"), (28, 31, "CUSTOM_PERSON")]}),
    # Add more examples as needed
]

# Convert training data to spaCy format
examples = []
for text, annotations in training_data:
    example = Example.from_dict(nlp.make_doc(text), annotations)
    examples.append(example)

# Train the NER model
nlp.begin_training()
for epoch in range(10):  # You might need to adjust the number of epochs
    for example in examples:
        nlp.update([example], drop=0.5)  # You can adjust the dropout rate

# Save the trained model
nlp.to_disk("path/to/your/custom_ner_model")
